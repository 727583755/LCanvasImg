/**
 * LCanvasImg图像文字二维码合成插件
 * 
 * version:1.0.0
 * 
 * author:黄磊
 * 
 * git:https://github.com/xfhxbb/LCanvasImg
 * 
 * 报告漏洞，意见或建议, 请联系邮箱：xfhxbb@yeah.net
 * 
 * Copyright 2016
 * 
 * Licensed under MIT
 * 
 * 获得使用本类库的许可, 您必须保留著作权声明信息
 * 
 * 最近修改于： 2017-2-15 11:48:11
 */
!function(){window.LCanvasImg=function(a){var t=this;t.params={cw:window.innerWidth,ch:window.innerHeight,iw:"100%",ih:"auto",itype:"image/jpeg",iquality:1,display:"none"};for(var e in a)t.params[e]=a[e];t.init()},LCanvasImg.prototype={init:function(){var a=document.querySelector("#LCanvasImg_canvas");if(a)a.width=this.params.cw,a.height=this.params.ch,a.style.display=this.params.display,this.canvas=a;else{var t=document.createElement("canvas");t.id="LCanvasImg_canvas",t.width=this.params.cw,t.height=this.params.ch,t.style.display=this.params.display,document.body.appendChild(t),this.canvas=t}this.clear()},clear:function(){var a=this,t=a.canvas,e=t.getContext("2d");e.clearRect(0,0,t.width,t.height)},load:function(a,t){var e=this,i=1;a.forEach(function(a,s,n){function r(){e[a.name]=h,i<n.length?++i:t()}var h=new Image;h.onload=r,h.onerror=r,h.src=a.src})},addFont:function(a){var t=this,e=t.canvas,i=e.getContext("2d");i.font=a.fontsize+"px "+a.fontfamily;var s=a.ftop,n=a.fleft;i.textBaseline="top",i.fillText(a.txt,n,s),i.lineWidth=1,i.fillStyle="#000",i.strokeStyle="rgba(255,255,255,0.4)",i.strokeText(a.txt,n,s)},addImg:function(a,t){var e=this,i=e.canvas,s=i.getContext("2d");a.hasOwnProperty("sx")&&a.hasOwnProperty("sy")&&a.hasOwnProperty("sw")&&a.hasOwnProperty("sh")&&a.hasOwnProperty("x")&&a.hasOwnProperty("y")&&a.hasOwnProperty("width")&&a.hasOwnProperty("height")?s.drawImage(e[a.name],a.sx,a.sy,a.sw,a.sh,a.x,a.y,a.width,a.height):a.hasOwnProperty("x")&&a.hasOwnProperty("y")&&a.hasOwnProperty("width")&&a.hasOwnProperty("height")?s.drawImage(e[a.name],a.x,a.y,a.width,a.height):a.hasOwnProperty("x")&&a.hasOwnProperty("y")?s.drawImage(e[a.name],a.x,a.y):s.drawImage(e[a.name],0,0)},showImg:function(){var a=this,t=a.canvas,e=document.querySelector("#LCanvasImg_img");if(e)e.style.width=a.params.iw,e.style.height=a.params.ih,e.src=t.toDataURL(a.params.itype,a.params.iquality);else{var i=new Image;i.id="LCanvasImg_img",i.style.width=a.params.iw,i.style.height=a.params.ih,i.src=t.toDataURL(a.params.itype,a.params.iquality),document.body.appendChild(i)}}}}();